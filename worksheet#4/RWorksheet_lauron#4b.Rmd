---
title: "RWorksheet_lauron_4b.Rmd"
author: "Mary Ghale C. Lauron"
date: "2025-11-07"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}


#1

vectorA <- c(1,2,3,4,5)

matrixA <- matrix(0, nrow = 5, ncol = 5)

for (i in 1:5) {
  for (j in 1:5) {
    matrixA[i, j] <- abs(i - j)
  }
}


#2

for (i in 1:5) {
  for (j in 1:i) {
    cat('"*"')
  }
  cat("\n")  
}


#3 fibonacci

start <- as.numeric(readline(prompt = "Enter starting number: "))

if (is.na(start)) {
  cat("Invalid input! Please enter a numeric value.\n")
} else {
  # Initialize first two Fibonacci numbers
  a <- 0
  b <- 1
  
  cat("Fibonacci sequence starting from", start, "up to 500:\n")
  
  repeat {
    # Only print numbers >= start
    if (a >= start) {
      cat(a, " ")
    }
    
    # Stop if the next number will be greater than 500
    if (a > 500) {
      break
    }
    
    # Generate next Fibonacci number
    temp <- a + b
    a <- b
    b <- temp
  }
  
  cat("\nDone!\n")
}


#4

#a For CSV and display first 6 rows
shoe_data <- read.csv("shoe_data.csv")

head(shoe_data)



#b Subset for males and females
male_subset <- shoe_data[shoe_data$Gender == "M", ]
female_subset <- shoe_data[shoe_data$Gender == "F", ]
male_subset
female_subset

# Count observations in each
nrow(male_subset)
nrow(female_subset)


gender_count <- table(shoe_data$Gender)

# Display counts
gender_count

#c Create a bar plot
barplot(gender_count,
        main = "Number of Males and Females in Household Data",
        xlab = "Gender",
        ylab = "Number of Individuals",
        col = c("pink", "lightblue"),
        legend.text = TRUE,
        args.legend = list(x = "topright", title = "Gender"))
        
        
# 5
expenses <- c(Food = 60, Electricity = 10, Savings = 5, Miscellaneous = 25)

labels <- paste0(names(expenses), 
                 " (", round(100 * expenses / sum(expenses), 1), "%)")

# Create pie chart
pie(expenses,
    main = "Monthly Expenses of Dela Cruz Family",
    col = c("orange", "yellow", "green", "blue"),
    labels = labels,
    clockwise = TRUE)

legend("topright", legend = names(expenses), fill = c("orange", "yellow", "green", "blue"))

  

#6 iris dataset
data(iris)

#a Check structure
str(iris)

#b mean of the sepal.length,sepal.width,petal.length,and petal.width.
iris_mean <- colMeans(iris[, 1:4])
iris_mean


#c Count species
species_distribution <- table(iris$Species)
species_distribution


labels <- paste0(names(species_distribution), 
                 " (", species_distribution, " | ", 
                 round(100 * species_distribution / sum(species_distribution), 1), "%)")

# Create pie chart
pie(species_distribution,
    main = "Species Distribution in Iris Dataset",
    col = c("purple", "pink", "lightblue"),
    labels = labels,
    clockwise = TRUE)

legend("topright", legend = names(species_distribution), fill = c("purple", "pink", "lightblue"))


#d Subset each species
setosa <- subset(iris, Species == "setosa")
versicolor <- subset(iris, Species == "versicolor")
virginica <- subset(iris, Species == "virginica")

#last 6 rows of each
tail(setosa)
tail(versicolor)
tail(virginica)



#e scatter_plot

data(iris)

iris$Species <- as.factor(iris$Species)


colors <- c("setosa" = "pink", "versicolor" = "purple", "virginica" = "blue")
symbols <- c("setosa" = 16, "versicolor" = 17, "virginica" = 18)

# Create scatterplot
plot(iris$Sepal.Length, iris$Sepal.Width,
     col = colors[iris$Species],
     pch = symbols[iris$Species],
     xlab = "Sepal Length",
     ylab = "Sepal Width",
     main = "Iris Dataset",
     sub = "Sepal width and length")

legend("topright",
       legend = levels(iris$Species),
       col = colors,
       pch = symbols)

#f. Interpret the result.
#Setosa species has wider sepal but shorter in length, the versicolor is in between or in average in  sepal width and sepal length, while the virginica has the longest sepal.
#The clear separation among clusters suggests that Sepal.Length and Sepal.Width can help distinguish species, though there is some overlap between versicolor and virginica.


  

#7 import alexa.xlsx

library(readxl)
alexa <- read_excel("alexa-file.xlsx")

# Show first rows
head(alexa)

alexa$variation <- gsub("\\s+", " ", alexa$variation)   
alexa$variation <- trimws(alexa$variation)            

#a Rename the variants
alexa$variation <- gsub("Black Dot", "Black - Dot", alexa$variation)
alexa$variation <- gsub("White Dot", "White - Dot", alexa$variation)
alexa$variation



# Count each variation
install.packages("dplyr")
library(dplyr)  

variations <- alexa %>%
  count(variation)

# Display result
print(variations)

# Save the object to an RData file
save(variations, file = "variations.RData")

# Load the saved data (example)
load("variations.RData")
variations 


#C
barplot(variations$n,
        names.arg = variations$variation,  
        main = "Alexa Variations Distribution",  
        xlab = "Variation Type",                 
        ylab = "Number of Units",               
        col = rainbow(nrow(variations)),       
        las = 2,                              
        border = "white")                      


#d

load("variations.RData")

# Separate Black and White variants
black <- variations[grep("Black", variations$variation), ]
white <- variations[grep("White", variations$variation), ]

par(mfrow = c(1, 2), mar = c(5, 5, 4, 2))  

#black
bar_black <- barplot(black$n,
                     names.arg = black$variation,
                     main = "Black Variants",
                     xlab = "Variant Type",
                     ylab = "Number of Units",
                     col = rainbow(nrow(black)), 
                     ylim = c(0, max(black$n) + 1),
                     border = "white",
                     las = 1)  

text(x = bar_black, y = black$n + 0.2, labels = black$n, cex = 0.8, col = "black")
#white
bar_white <- barplot(white$n,
                     names.arg = white$variation,
                     main = "White Variants",
                     xlab = "Variant Type",
                     ylab = "Number of Units",
                     col = rainbow(nrow(white)), 
                     ylim = c(0, max(white$n) + 1),
                     border = "white",
                     las = 1) 

text(x = bar_white, y = white$n + 0.2, labels = white$n, cex = 0.8, col = "black")

par(mfrow = c(1, 1))

```